<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <form id="form">
        <label for="firstName">First name</label>
        <input type="text" id="firstName" name="firstName">
        <label for="lastName">Last name</label>
        <input type="text" id="lastName" name="lastName">
        <input type="submit" value="submit">

    </form>

    <script>
        const url = "http://localhost:8080"
        let data;

        const getData = async () => {
            const id = localStorage.id;
            const res = await fetch(`${url}/customer/${id}`);
            data = JSON.parse(await res.text());

            fillVal();
        }

        const fillVal = () => {
            document.getElementById("firstName").value = data.firstName;
            document.getElementById("lastName").value = data.lastName;
        }

        const listeners = () => {
            document.getElementById("form").addEventListener("submit", async e => {
                e.preventDefault();
                const firstName = e.target.firstName.value;
                const lastName = e.target.lastName.value;

                await fetch(`${url}/customer`, {
                    method: "PUT",
                    headers: {
                        'Content-Type': 'application/json',
                    }, body: JSON.stringify({ ...data, firstName, lastName })
                });
                window.location = "index.html";
            })

        }

        (() => {
            getData();
            listeners();
        })()
    </script>
</body>

</html>